{"version":3,"sources":["js/chat.js"],"names":["url","stompClient","selectedUser","connectToChat","userName","console","log","socket","SockJS","Stomp","over","connect","frame","subscribe","response","data","JSON","parse","body","render","message","fromLogin","sendMsg","from","text","send","stringify","registration","username","document","getElementById","value","$","get","fail","error","status","alert","selectUser","isNew","element","parentNode","removeChild","newMessages","html","append","fetchAll","users","usersTemplateHTML","i","length","onclick"],"mappings":"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","file":"chat.3458631b.js","sourceRoot":"..","sourcesContent":["const url = 'http://localhost:8087';\nlet stompClient;\nlet selectedUser;\n\nfunction connectToChat(userName){\n    console.log(\"connecting to chat .....\"+ userName)\n    let socket = new SockJS(url + \"/chat\")\n    console.log(socket)\n    stompClient = Stomp.over(socket);\n    console.log(stompClient)\n    stompClient.connect({}, function(frame) {\n       console.log(\"connected to : \" + frame );\n       stompClient.subscribe(\"/topic/message/\"+userName, function(response){\n           let data = JSON.parse(response.body);\n           render(data.message, data.fromLogin)\n       });\n    })\n}\n\nsendMsg = (from , text) => {\n    console.log(stompClient)\n    stompClient.send(\"/app/chat/\"+ selectedUser, {} , JSON.stringify({\n        fromLogin :  from,\n        message : text\n    }))\n}\n\n\nfunction registration() {\n    let username = document.getElementById(\"userName\").value;\n    console.log(username)\n    $.get(url + \"/registration/\" + username, function (response) {\n        connectToChat(username);\n    }).fail(function (error) {\n        if (error.status === 400) {\n            alert(\"Login is already busy!\")\n        }\n    })\n}\n\n\nselectUser = (userName)=>{\n    console.log(\"selecting users: \" + userName);\n    selectedUser = userName;\n    let isNew = document.getElementById(\"newMessage_\" + userName) !== null;\n    if (isNew) {\n        let element = document.getElementById(\"newMessage_\" + userName);\n        element.parentNode.removeChild(element);\n        render(newMessages.get(userName), userName);\n    }\n    $('#selectedUserId').html('');\n    $('#selectedUserId').append('Chat with ' + userName);\n}\n\n\n\n\nfunction fetchAll() {\n    $.get(url + \"/fetchAllUsers\", function (response) {\n        let users = response;\n        console.log(response)\n        let usersTemplateHTML = \"\";\n        for (let i = 0; i < users.length; i++) {\n            usersTemplateHTML = usersTemplateHTML + '<a href=\"#\" onclick=\"selectUser(\\'' + users[i] + '\\')\"><li class=\"clearfix\">\\n' +\n                '                <img src=\"https://cdn.pixabay.com/photo/2013/07/13/10/07/man-156584_1280.png\" width=\"55px\" height=\"55px\" alt=\"avatar\" />\\n' +\n                '                <div class=\"about\">\\n' +\n                '                    <div id=\"userNameAppender_' + users[i] + '\" class=\"name\">' + users[i] + '</div>\\n' +\n                '                    <div class=\"status\">\\n' +\n                '                        <i class=\"fa fa-circle offline\"></i>\\n' +\n                '                    </div>\\n' +\n                '                </div>\\n' +\n                '            </li></a>';\n        }\n        $('#usersList').html(usersTemplateHTML);\n    });\n}\n\n\n\ndocument.getElementById(\"testbutton\").onclick =  function (){\n    registration();\n};\n\n\ndocument.getElementById(\"fetchman\").onclick =  function (){\n    console.log(\"hello\");\n    fetchAll();\n};\n\n"]}